\begin{defn}
        Let $\mathfrak{q} \in A$ be a proper ideal.
        We say that $\mathfrak{q}$ is \emph{primary} if fot all $a, b \in A$
        \[
            ab \in \mathfrak{q}, a \notin \mathfrak{q}
            \Longrightarrow b^n \in \mathfrak{q} \text{ for some } n > 0
        \]
\end{defn}

\begin{rk}
    We have:
    \begin{itemize}
        \item $\mathfrak{p}$ prime ideal $\Longrightarrow \mathfrak{p}$ primary ideal.
        \item $\mathfrak{p}$ primary ideal $\notimplies \mathfrak{p}$ prime ideal.
        \item Let $f: A \longrightarrow B$ be a ring homomorphism.
        Then,
        \[
            \mathfrak{q} \subseteq B \text{ primary ideal }
            \Longrightarrow \mathfrak{q}^c \subseteq A \text{ primary ideal}
        \]
    \end{itemize}
\end{rk}

\begin{prop}
    $\mathfrak{q} \text{ primary ideal } \Longrightarrow rad(\mathfrak{q}) \text{ prime ideal }$
\end{prop}
    \begin{proof}

        Let $ab \in rad(\mathfrak{q})$.
        Suppose $a \notin rad(\mathfrak{q})$.
        In particular, $a \notin \mathfrak{q}$.
        Then, $b^n \in \mathfrak{q}$ for some $n > 0$.
        Therefore, $b \in rad(\mathfrak{q})$.

    \end{proof}

\begin{defn}
    In the conditions of the previous proposition,
    we say that $\mathfrak{q}$
    is $\mathfrak{p}$-primary.
\end{defn}


\begin{prop}
    Let $\mathfrak{q} \subseteq A$ be an ideal s.t.
    $rad(\mathfrak{q}) = \mathfrak{m}$ is a maximal ideal.
    Then $\mathfrak{q}$ is primary.

    \begin{proof}
        Let $ab \in \mathfrak{q}$.
        Consider the inclusions $\mathfrak{m} \subseteq \mathfrak{m} + (b) \subseteq A$.
        Because $\mathfrak{m}$ is maximal, we must have equality in (exactly) one of the two:

        \begin{itemize}

            \item If the second inclusion is an equality,
            \item we have $1 = x + by$, for some $x \in \mathfrak{m}$ and $y \in A$.
            Then, $a = ax + aby \Rightarrow a(1-x) = aby \in \mathfrak{q}$.
            However, reducing modulo $\mathfrak{q}$, we see $\bar{a}\overline{(1-x)} = \bar{0}$
            and $\overline{x} \in \mathcal{N}(A/\mathfrak{q}) \Rightarrow \overline{1-x}$ is a unit.
            Therefore. $\bar{a} = \bar{0}$, which means $a \in \mathfrak{q}$.

            \item If the first inclusion is an equality, we have
            $b \in \mathfrak{m} = rad(\mathfrak{q})
            \Rightarrow b^n \in \mathfrak{q}$ for some $n > 0$.

        \end{itemize}
    \end{proof}

\end{prop}

\begin{defn}
    Let $A$ be a ring and $I \subseteq A$ an ideal.
    A \emph{primary decomposition} of $I$ is a representation of $I$
    as an intersection of primary ideals,
    say, $I = \mathfrak{q}_1 \cap \cdots \cap \mathfrak{q}_n$ with $\mathfrak{q}_i$ primary.
    We say that such a decomposition is \emph{minimal} or \emph{reduced} if:

    \begin{enumerate}
        \item
        $\mathfrak{p}_i \coloneqq \text{rad}(\mathfrak{q}_i)$
        are distinct prime ideals. \label{item:distinct-primes}

        \item
        $\bigcap_{j \neq i} \mathfrak{q}_j \not\subset \mathfrak{q}_i $
        for all $i$. \label{item:noninclusion}
    \end{enumerate}
\end{defn}

\begin{rk}
    Given a primary decomposition of $I$, we can always find a reduced one.
    This is because if the decomposition is not reduced,
    we can decrease the number of primary ideals involved.
    If condition~\ref{item:noninclusion} is not satisfied for some $i$,
    we can remove $\mathfrak{q}_i$ from the decomposition and the equality will still hold.
    If condition~\ref{item:distinct-primes} is not satisfied
    (say, $\mathfrak{p}_i = \mathfrak{p}_j = \mathfrak{p}$),
    then we can replace $\mathfrak{q}_i$ and $\mathfrak{q}_j$ by
    $\mathfrak{q} \coloneqq \mathfrak{q}_i \cap \mathfrak{q}_j$.
    To check that $\mathfrak{q}$ is ($\mathfrak{p}$ -) primary,
    note that (by an extra exercise) $\text{rad}(\mathfrak{q}) = \mathfrak{p}$
    and if $ab \in \mathfrak{q}$ and $a \notin \mathfrak{q}$,
    we can assume $a \notin \mathfrak{q_i} \Rightarrow b \in \mathfrak{p}$.
\end{rk}

\begin{rk}
    However, minimal decompositions are not completely unique.
    In the following propositions, we will produce some invariants of these decompositions.
\end{rk}

\begin{lemma}
    Let $A$ be a ring, let $\mathfrak{q}$ be a $\mathfrak{p}$-primary ideal of $A$
    and let $a \in A$.
    If \linebreak ${(\mathfrak{q} : a) \coloneqq \{x \in A \mid ax \in \mathfrak{q}\}}$,
    then:

    \begin{enumerate}
        \item $a \in \mathfrak{q} \Rightarrow (\mathfrak{q} : a) = A$.
        \item $a \notin \mathfrak{q} \Rightarrow (\mathfrak{q} : a)$ is $\mathfrak{p}$-primary.
        \item $a \notin \mathfrak{p} \Rightarrow (\mathfrak{q} : a) = \mathfrak{q}$
    \end{enumerate}

    \begin{proof}
        We will show them in order:
        \begin{enumerate}

            \item
            Trivial.

            \item
            Let us first prove that $\text{rad}\,((\mathfrak{q} : a)) = \mathfrak{p}$.
            We have inclusions
            $\mathfrak{q} \subseteq (\mathfrak{q} : a) \subseteq \mathfrak{p}$,
            where the second one holds because
            $ab \in \mathfrak{q}, a \notin q \Rightarrow b \in \mathfrak{p}$
            (by definition of $\mathfrak{p}$-primary).
            Taking radicals, we get
            $\mathfrak{p} \subseteq \text{rad}\,((\mathfrak{q} : a)) \subseteq \mathfrak{p}$.
            Now, let $cd = b \in (\mathfrak{q} : a)$ (that is, $acd \in \mathfrak{q}$),
            and suppose $c \notin (\mathfrak{q} : a)$.
            This means that $ac \notin \mathfrak{q}$, so $d \in \mathfrak{p}$.

            \item
            Suppose that $b \in (\mathfrak{q} : a)$ and $b \notin \mathfrak{q}$.
            Because $ab \in \mathfrak{q}$ and $\mathfrak{q}$ is $\mathfrak{p}$-primary,
            this implies $a \in \mathfrak{p}$.

        \end{enumerate}
    \end{proof}
\end{lemma}

\begin{exercise}
    Let $A$ be a ring, $\mathfrak{p}$ a prime ideal of $A$ and $I_1, \ldots, I_n$ ideals of $A$.
    Suppose that $I_1 \cap \cdots \cap I_n \subseteq \mathfrak{p}$.
    Then, there exists $i$ such that $I_i \subseteq \mathfrak{p}$.
    \begin{proof}
        We will proceed by induction on $n$.
        \begin{enumerate}
            \item
            For $n=1$ there is nothing to prove.

            \item
            For $n=2$, suppose that
            $a \in I_1 \setminus \mathfrak{p},
            b \in I_2 \setminus \mathfrak{p}$.
            Then, $ab \in I_1 \cap I_2 \subseteq \mathfrak{p}$,
            which is a contradiction with the fact that $\mathfrak{p}$ is prime.

            \item For $n > 2$, we can apply the $n = 2$ case to
            $I_1 \cap \cdots \cap I_{n-1}$ and $I_n$.
            Then if $I_n \in \mathfrak{p}$ we are done and if
            $I_1 \cap \cdots \cap I_{n-1} \subseteq \mathfrak{p}$,
            we apply the case $(n-1)$st case.
        \end{enumerate}

    \end{proof}
\end{exercise}


\begin{theorem}
    Let $A$ be a ring.
    Let $I = \mathfrak{q}_1 \cap \cdots \cap \mathfrak{q}_n$ be a minimal primary decomposition in $A$.
    Then,
    \[\{\mathfrak{p}_1 \ldots \mathfrak{p}_n\} =
    \{\text{rad}\,(I : a) \mid a \in A\} \cap \text{Spec}\,A\]

    \begin{proof}
        Observe that if $a \in A$,
        \[(I:a) =
        \left( \left(\bigcap_i \mathfrak{q}_i\right) : a \right )
        = \bigcap_i (\mathfrak{q}_i : a)
        \]
        Were the second equality has been shown in an exercise.
        Taking radicals,
        \[
            \text{rad}\,(I:a) = \bigcap_i \text{rad}\,((\mathfrak{q}_i : a))
            = \bigcap_{a \notin \mathfrak{q}_i} \mathfrak{p}_i
        \]
        Where the last equality follows from the previous lemma.
        We are now ready to show both inclusions in the statement:

        \begin{itemize}
            \item[$(\supseteq)$]
            If $\text{rad}\,((I : a))$ is prime,
            by the exercise, there exists $i$ such that
            $\mathfrak{p}_i \subseteq \text{rad}\,(I : a)$.
            But because $\text{rad}\,(I : a)$ is the intersection of them all,
            we must have $\text{rad}\,(I : a) = \mathfrak{p}_i$.

            \item[$(\subseteq)$]
            It is known that they are all prime ideals.
            We need to show that for all $i$, there exists $a \in A$ such that
            $\mathfrak{p}_i = \text{rad}\,(I : a)$.
            It is here that we use the minimality of the decomposition:
            We just choose $a \in \bigcap_{j \neq i} \mathfrak{q}_j \setminus \mathfrak{q}_i $.
            Then, $\text{rad}\,(I : a) = \bigcap_{a \notin \mathfrak{q}_j} \mathfrak{p}_j = \mathfrak{p}_i$.


        \end{itemize}

    \end{proof}
\end{theorem}

\begin{rk}
    This means that the set $\{\mathfrak{p}_1 \ldots \mathfrak{p}_n\}$
    is independent of the choice of the decomposition.
    We call them the \emph{associated primes} of $I$ in $A$
    or $\text{Ass}\,(A/I)$.

\end{rk}

\begin{theorem}
    With the same notation, the set \[\{\mathfrak{q}_i \mid \mathfrak{p}_i \text{ minimal prime of A containing I w.r.t. inclusion}\}\]
    does not depend on the minimal primary decomposition.

    \begin{proof}
        TODO %TODO
    \end{proof}
\end{theorem}

\begin{defn}
    We call this set the \emph{minimal primary components} of $I$ in $A$ or $\text{Min}\,(A/I)$.
\end{defn}

