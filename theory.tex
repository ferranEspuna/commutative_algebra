%! Author = fespuna
%! Date = 8/10/23

% Preamble
\documentclass[11pt]{article}

% Packages
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{tikz-cd}
\usepackage{wasysym}
\usepackage{stmaryrd}
\usepackage{xfrac}
%These are my Commutative Algebra Teory notes from the course given by Prof. Josep Alvarez Montaner at UPC in 2023.

% Title
\title{Commutative Algebra. Theory}
\author{Ferran Espuña}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{prop}[theorem]{Proposition}

\theoremstyle{definition}
\newtheorem{defn}[theorem]{Definition}
\newtheorem{rk}[theorem]{Remark}

% Commands
\newcommand{\notimplies}{\;\not\!\!\!\implies}

% Document
\begin{document}

    \maketitle

    \section{Rings and Ideals}\label{sec:rings-and-ideals}

        \begin{rk}
            Unless otherwise specified, all rings we discuss will be commutative with unit.
        \end{rk}

        \begin{defn}
            Let $A$, $B$ be rings.
            We say that $f: A \longrightarrow B$ is a \emph{ring homomorphism} if for all $a, b \in A$:
            \begin{itemize}
                \item $f(a+b) = f(a) + f(b)$
                \item $f(ab) = f(a) f(b)$
                \item $f(1_A) = 1_B$
            \end{itemize}
        \end{defn}

        \begin{defn}
            We say that $I \subseteq A$ is an \emph{ideal} if:
            \begin{itemize}
                \item $(I,+)$ is an abelian group.
                \item For all $a \in A$ and for all $x\in I$, $ax \in I$.
            \end{itemize}
        \end{defn}

        \begin{defn}
            We define:
            \begin{itemize}
                \item The \emph{radical} of an ideal $I$ is $rad(I) \coloneqq \{a \in A \mid a^{n} \in I, n > 0\}$.
                \item (\emph{Colon ideal}) $(I:J) \coloneqq \{a \in A \mid aJ \subseteq I\}$.
                \item (\emph{Saturation}) $(I:J^{\infty}) \coloneqq \{a \in A \mid \exists n > 0 \text{ s.t. } a J^n \subseteq I\}$.
            \end{itemize}
        \end{defn}

        \begin{defn}
            Let $f: A \rightarrow B$ be a ring homomorphism, and let $J \subset B$ be an ideal.
            Then, the \emph{contraction} of $J$ to $A$ is $J^{c} \coloneqq \{a \in A \mid f(a) \in J\}$.
        \end{defn}

        \begin{prop}
            In the above situation, $J^{c}$ is an ideal of $A$.
        \end{prop}

            \begin{proof}
                It is an additive subgroup of $A$ as $f$ is an additive group homomorphism.
                Furthermore, if $a \in J^{c}$ and $r \in A$, then $f(a) \in J$ so $f(ra) = f(r)f(a) \in J$ as $J$ is an ideal.
            \end{proof}

        \begin{defn}
            Let R be a ring and $S \subset R$ a subset.
            Then, the \emph{ideal generated by} $S$ is $\langle S \rangle \coloneqq \bigcap_{I \supset S} I$, where $I$ ranges over all ideals of $R$.
        \end{defn}

        \begin{rk}
            $\langle S \rangle$ is the smallest ideal of $R$ containing $S$.
            It can be checked that it is indeed an ideal by noticing that all elements of it belong to all ideals containing $S$,
            and veryfying the axioms from there.
        \end{rk}

        \begin{prop}
            In the above situation,
            \begin{align}
                \langle S \rangle = \{a_1 s_1 + \cdots + a_n s_n\ \mid n \in \mathbb{N}, a_1, \ldots, a_n \in A, s_1, \ldots, s_n \in S\} \nonumber
            \end{align}
        \end{prop}

            \begin{proof}
                We will show both inclusions.
                \begin{itemize}
                    \item[$(\subset)$] $\langle S \rangle$ is an ideal containing $S$, so it contains all elements of the form $a_1 s_1 + \cdots + a_n s_n$.
                    \item[$(\supset)$] One can easily check that the set on the right is an ideal containing $S$,
                    so it contains the intersection of all such ideals, which is $\langle S \rangle$.
                \end{itemize}
            \end{proof}

        \begin{defn}
            Let $f: A \rightarrow B$ be a ring homomorphism, and let $I \subset A$ be an ideal.
            Then, the \emph{extension} of $ I$ to $B$ is $IB = I^{e} \coloneqq \langle f(I) \rangle$.
        \end{defn}

        \begin{rk}
            $I^{e}$ is by contstruction, the smallest ideal of $B$ containing $f(I)$.
        \end{rk}

        \begin{prop} \label{prop:extension-and-contraction}
            In the above situation, let $I^{ec} \coloneqq (I^e)^c$, and similarly for the rest.
            Then:
            \begin{enumerate}
                \item $I \subset I^{ec}$.
                \item $J^{ce} \subset J$
                \item $I^e = I^{ece}$
                \item $J^c = J^{cec}$
            \end{enumerate}
        \end{prop}

        \begin{proof}
            Note that if $K$ is an ideal of $A$, then $f(K) \subset K^e$.
            Furthermore, extension and contraction clearly respect inclusions.
            \begin{enumerate}
                \item $I \subset f^{-1}(f(I)) \subset f^{-1}(I^e) = I^{ec}$.
                \item $(J^{c})^e = \langle f(J^c) \rangle = \langle f(f^{-1}(J))\rangle \subset \langle J  \rangle = J$.

                \item By the two previous points, $(I^e)^{ce} \subset I^e$ and $I\subset I^{ec}$ so
                $I^e \subset (I^{ec})^e$.

                \item Similarly, $J^c \subset (J^c)^{ec}$ and $J^{ce} \subset J$ so
                $(J^{ce})^c \subset J^c$.
            \end{enumerate}
        \end{proof}

        \begin{defn}
            Let $I$ be an ideal of a ring $A$.
            The \emph{quotient ring} $A/I$ is the ring whose elements are the cosets of $I$ in $A$, and whose operations are defined by
            \begin{align}
                (a + I) + (b + I) &= (a + b) + I \nonumber \\
                (a + I) \cdot (b + I) &= (a \cdot b) + I \nonumber
            \end{align}
        \end{defn}

        \begin{rk}
            The sum operation is well defined as it is for all quotient groups.
            The product operation is well defined as $I$ is an ideal so if $p \in (a + I)$, $q \in (b + I)$,
            then $pq \in ab + aI + bI + I^2 \subset (ab + I)$.
        \end{rk}

        \begin{prop}
            Let $I$ be an ideal of a ring $A$.
            Then, the canonical projection $\pi: A \rightarrow A/I$ is a ring homomorphism.
        \end{prop}

                \begin{proof}
                    It is clearly a group homomorphism.
                    Furthermore, $\pi(a) \pi(b) = (a + I) (b + I) = ab + I = \pi(ab)$.
                    Finally, $\pi(1) = 1 + I$ is clearly the unit of $A/I$.
                \end{proof}

        \begin{defn}
            Let $I \subsetneq R$ be an ideal.
            Then:

            \begin{itemize}
                \item $I$ is \emph{prime} if $ab \in I \Rightarrow a \in I \text{ or } b \in I$.
                \item $I$ is \emph{maximal} there are no ideals $J$ such that $I \subsetneq J \subsetneq R$.
            \end{itemize}

            We further define the \emph{spectrum} of $R$ as

            \begin{align}
                \text{Spec}(R) \coloneqq \{\mathfrak{p} \subset R \text{ ideal} \mid \mathfrak{p} \text{ is prime}\}. \nonumber
            \end{align}

            and

            \begin{align}
                \text{Max}(R) \coloneqq \{\mathfrak{m} \subset R \text{ ideal} \mid \mathfrak{m} \text{ is maximal}\}. \nonumber
            \end{align}

        \end{defn}

        \begin{prop}
            Let $\mathfrak{p} \subset R$ be an ideal.
            Then, $\mathfrak{p} \in \text{Spec}(R) \Leftrightarrow R/\mathfrak{p}$ is an integral domain.
        \end{prop}
            \begin{proof}
                Let \begin{align}
                    \pi: R &\rightarrow R/\mathfrak{p} \nonumber \\
                        a &\mapsto \bar{a} \coloneqq a + \mathfrak{p} \nonumber
                \end{align}
                be the canonical projection.
                Then, $\pi$ is a ring homomorphism.
                Suppose $a, b \in R$.
                Then,

                \begin{align}
                    ab \in \mathfrak{p} &\Leftrightarrow \bar{a}\bar{b} = 0 \nonumber \\
                    (a \in \mathfrak{p} \text{ or } b \in \mathfrak{p}) &\Leftrightarrow (\bar{a} = 0 \text{ or } \bar{b} = 0) \nonumber
                \end{align}
                Therefore, as $\pi$ is surjective, $R/\mathfrak{p}$ is an integral domain if and only if $\mathfrak{p}$ is prime,
                as both conditions are equivalent to the first condition implying the second.
            \end{proof}

        \begin{lemma}
                     A ring S is a field if and only if it has no nontrivial ideals $ 0 \subsetneq I \subsetneq S$
        \end{lemma}
                \begin{proof}
                    We will show both implications.

                    \begin{itemize}
                        \item [$(\Rightarrow)$] Let $ 0 \subsetneq I \subsetneq S$ be an ideal.
                        Then, it has a nonzero element $a$ which must be a unit, so
                        $1 = a a^{-1} \in I$, so $I \subsetneq S = (1) \subset I$, a contradiction.

                        \item[$(\Leftarrow)$] Let $a \in S$ be nonzero.
                        Then, $(a) \neq 0$ so $(a) = S$, so $1 \in (a)$, so $a$ is a unit.
                    \end{itemize}

                \end{proof}
    
        \begin{prop}
            Let $\mathfrak{m} \subset R$ be an ideal.
            Then, $\mathfrak{m} \in \text{Max}(R) \Leftrightarrow R/\mathfrak{m}$ is a field.
        \end{prop}

            \begin{proof}
                We will use the above characterization of fields.
                Because the canonical projection $\pi: R \rightarrow R/\mathfrak{m}$ is surjective,
                Contraction by it respects inequalities, that is $I \subsetneq J \Rightarrow I^c \subsetneq J^c$.
                On the other hand, for ideals containing $\mathfrak{m}$, extension by $\pi$ is just the canonical projection,
                so $I \subsetneq J \Rightarrow I^e \subsetneq J^e$.
                Finally, $R^e = R/\mathfrak{m}$ and $(R/\mathfrak{m})^c = R$.
                Therefore, we have a bijection between notrivial ideals of $R/\mathfrak{m}$
                and ideals $\mathfrak{m} \subsetneq I \subsetneq R$.
                One of the sets is empty if and only if the other is.
            \end{proof}

        \begin{rk}
            All fields are integral domains, so $\text{Max}(R) \subset \text{Spec}(R)$.
            That is, all maximal ideals are prime.
        \end{rk}

        \begin{theorem}
            All rings have maximal ideals.
        \end{theorem}
            \begin{proof}
                Exercise.
                Use Zorn's lemma.
            \end{proof}

        \begin{theorem}
            Let $A$ be a ring and $I \subseteq A$ be an ideal.
            Then, there exists a maximal ideal $\mathfrak{m} \subseteq A$ such that $I \subseteq \mathfrak{m}$.
        \end{theorem}
            \begin{proof}
                Exercise.
                Use Zorn's lemma.
            \end{proof}

        \begin{defn}
            We say that a ring $R$ is \emph{local} if it has a unique maximal ideal $\mathfrak{m}$.
        \end{defn}

        \begin{prop} \label{prop:local}
            Let $R$ be a ring.
            R is local if and only if $R \setminus R^*$ is an ideal (which is then necessarily the maximal ideal).
        \end{prop}

            \begin{proof}
            We will show both implications.
                \begin{itemize}
                    \item[$(\Rightarrow)$] Let $R$ be local with maximal ideal $\mathfrak{m}$.
                    We will show that $\mathfrak{m}$ is exactly $R \setminus R^*$.
                    Let $a \in R \setminus R^*$.
                    Then, $(a) \neq R$ so $(a) \subset \mathfrak{m}$, as it must be contained in some maximal ideal.
                    In particular, $a \in \mathfrak{m}$.
                    On the other hand,
                    if $a \in \mathfrak{m}$, then $(a) \subset \mathfrak{m} \subsetneq R$, so $a \notin R^*$.

                    \item[$(\Leftarrow)$] Let $I \subsetneq R$ be an ideal.
                    If it contained a unit, then it would contain $1$, so $I = R$.
                    Therefore, $I \subset R \setminus R^*$ so the latter is the unique maximal ideal.
                \end{itemize}
            \end{proof}

        \begin{defn}
            Let $R$ be a ring and $S \subset R$ a subset.
            We say that $S$ is \emph{multiplicatively closed} if $1 \in S$ and $a, b \in S \Rightarrow ab \in S$.
        \end{defn}

        \begin{defn}
            Let $R$ be a ring and $S \subset R$ a multiplicatively closed subset.
            Then, $S^{-1}R \coloneqq \{\frac{a}{b} \mid a \in R, b \in S\}/\sim$,
            where

            \begin{align}
                \frac{a}{s} \sim \frac{b}{t}  \Leftrightarrow \exists r \in S \colon  r (at - bs) = 0
            \end{align}
        \end{defn}

        \begin{prop}
            In the definition above, $\sim$ is an equivalence relation.
        \end{prop}

            \begin{proof}
                The relation is obviously symmetric and reflexive.
                Let us show that it is transitive.
                Suppose $\frac{a_1}{s_1} \sim \frac{a_2}{s_2} \sim \frac{a_3}{s_3} $:
                \begin{align}
                    t_1 (a_1 s_2 - a_2 s_1) &= 0 \nonumber \\
                    t_2 (a_2 s_3 - a_3 s_2) &= 0 \nonumber
                \end{align}
                For some $t_1, t_2 \in S$.
                Then, multiply the first equation by $t_2 s_3$ and the second by $t_1 s_1$ to get
                \begin{align}
                    t_1 t_2 s_3 a_1 s_2 - t_1 t_2 s_3 a_2 s_1 &= 0 \nonumber \\
                    t_1 t_2 s_1 a_2 s_3 - t_1 t_2 s_1 a_3 s_2 &= 0 \nonumber
                \end{align}
                Adding both equations and collecting like terms, we get
                \begin{align}
                    0 = t_1 t_2 s_3 a_1 s_2 - t_1 t_2 s_1 a_3 s_2 = t_1 t_2 s_2 (a_1 s_3 - a_3 s_1)  \nonumber \\
                \end{align}
                Because $S$ is multiplicatively closed, $t_1 t_2 s_2 \in S$, so $\frac{a_1}{s_1} \sim \frac{a_3}{s_3}$.

            \end{proof}

        \begin{prop}
            The usual operations
            \begin{align}
                \frac{a}{s} + \frac{b}{t} &= \frac{at + bs}{st} \nonumber \\
                \frac{a}{s} \cdot \frac{b}{t} &= \frac{ab}{st} \nonumber
            \end{align}
            are well defined and make $S^{-1}R$ into a ring.
        \end{prop}
            \begin{proof}
                Left as an exercise.
                The arguments are tedious but similar to the above proposition. %\todo{Exercise}
            \end{proof}

        \begin{prop}
            Let $R$ be a ring and $S \subset R$ a multiplicatively closed subset.
            Then, the canonical projection
                \begin{align}
                \pi: R &\rightarrow S^{-1}R \nonumber \\
                    a &\mapsto \frac{a}{1} \nonumber
                \end{align}
            is a ring homomorphism.
            It is injective if and only if $S$ contains no zero divisors.
        \end{prop}

            \begin{proof}
                $\pi(1) = \frac{1}{1}$ is clearly the unit of $S^{-1}R$.
                Furthermore, $\pi(a) \pi(b) = \frac{a}{1} \frac{b}{1} = \frac{ab}{1} = \pi(ab)$.
                $\pi(a) + \pi(b) = \frac{a}{1} + \frac{b}{1} = \frac{1 \cdot a + 1 \cdot b}{1 \cdot 1} = \frac{a+b}{1} = \pi(a + b)$.
                We have that it is a ring homomorphism. $\text{Ker}(\pi) = \{a \in R \mid | \frac{a}{1} \sim \frac{0}{1}\} =
                \{a \in R \mid | \exists s \in S \mid \ 0 = s (a \cdot 1 + 0 \cdot 1) = sa\}$.
                Indeed, the kernel is the set of all elements of $R$ that are annihilated by some element of $S$.
                In particular, it contains only zero if and only if $S$ contains no zero divisors.
            \end{proof}

        \begin{prop} \label{prop:universal-property-fractions}
            Let $A$ be a ring and $S \subset A$ a multiplicatively closed subset.
            Let $f: A \rightarrow B$ be a ring homomorphism such that $f(S) \subset B^*$.
            Then, there exists a unique ring homomorphism
            $g: S^{-1}A \rightarrow B$ such that $f = g \circ \pi$, where $\pi$
            is the canonical projection.
            That is, the following diagram commutes:

            \begin{center}
            \begin{tikzcd}[row sep=huge,column sep=huge]
            A \arrow{r}{f} \arrow[swap]{d}{\pi} & B \\
            S^{-1}A \arrow[dashed]{ur}{\exists ! g}
            \end{tikzcd}
            \end{center}

        \end{prop}

            \begin{proof}
                Suppose that such a $g$ exists.
                By definition,
                \begin{align}
                    g\bigg(\frac{a}{1}\bigg) = f(a) \nonumber
                \end{align}
                For any $s \in S, $
                \begin{align}
                    1 = f(1) = g\bigg(\frac{s}{1} \frac{1}{s}\bigg) = g\bigg(\frac{s}{1}\bigg) g\bigg(\frac{1}{s}\bigg)  \Rightarrow
                    g\bigg(\frac{1}{s}\bigg) = g\bigg( \frac{s}{1}\bigg)^{-1}  = f(s)^{-1} \nonumber
                \end{align}
                Then,
                \begin{align}
                    g\bigg(\frac{a}{s}\bigg) = g\bigg(\frac{a}{1} \frac{1}{s}\bigg) = g\bigg(\frac{a}{1}\bigg) g\bigg(\frac{1}{s}\bigg) = f(a) f(s)^{-1} \nonumber
                \end{align}
                Therefore, $g$ is uniquely determined by $f$.
                The derived expression for $g$ clearly makes the diagram commute.
                Finally, we will show that it is well defined and that it is a ring homomorphism.
                Suppose $\frac{a}{s} = \frac{b}{t}$.
                Then, for some $u \in S$,
                \begin{align}
                     u(at - bs) = 0 \Rightarrow 0 = f(0) = f(u(at - bs)) = f(u) (f(a) f(t) - f(b) f(s)) \nonumber
                \end{align}
                But $f(u), f(s), f(t)\in B^*$, so
                \begin{align}
                    f(a) f(t) = f(b) f(s) \Rightarrow g\bigg(\frac{a}{s}\bigg) =
                    f(a) f(s)^{-1} = f(b) f(t)^{-1} = g\bigg(\frac{b}{t}\bigg)\nonumber
                \end{align}
                Therefore, $g$ is well defined.
                Finally, let us check that it is a ring homomorphism:
                \begin{itemize}
                    \item $g(\frac{a}{s}) + g(\frac{b}{t}) = f(a) f(s)^{-1} + f(b) f(t)^{-1} = f(a) f(t) f(t)^{-1} f(s)^{-1} + f(b) f(s) f(t)^{-1} f(s)^{-1} =
                f(at + bs)f(st)^{-1} = g(\frac{at + bs}{st}) = g(\frac{a}{s} + \frac{b}{t})$
                    \item$g(\frac{a}{s}) g(\frac{b}{t}) = f(a) f(s)^{-1} f(b) f(t)^{-1} = f(ab) f(st)^{-1} = g(\frac{ab}{st}) = g(\frac{a}{s} \frac{b}{t})$
                    \item$g(\frac{1}{1}) = 1$
                \end{itemize}

            \end{proof}

        \begin{prop} \label{prop:extension-in-fractions}
            In the above situation, let $I \subset A$ be an ideal.
            Consider the canonical projection $\pi: A \rightarrow S^{-1}A$.
            Then we can write the extension of $I$ by $\pi$ as
            $I^{e} \eqqcolon IS^{-1}A = S^{-1}I \coloneqq \{\frac{j}{s} \mid j \in I, s \in S \}$.
            Furthermore, every ideal of $S^{-1}A$ is of this form.
        \end{prop}
            \begin{proof}
                    It is clear that $S^{-1}I \subset IS^{-1}A$.
                    Suppose that $x = \frac{j_1}{1} \frac{a_1}{s_1} + \cdots + \frac{j_n}{1} \frac{a_n}{s_n} \in IS^{-1}A$,
                    with $j_i \in I, a_i \in A, s_i \in S$.
                    Then, by applying the definition of addition repeatedly, we get
                    $x = \frac{j}{s}$, with $j \in I$.
                    Therefore $x \in I^{-1}B$.

                    \noindent Now, take any ideal $J \subset S^{-1}A$.
                    We know by~\ref{prop:extension-and-contraction} $J^{ce} \subset J$.
                    We will show the reverse inclusion in this case.
                    Let $\frac{a}{s} \in J.$ Then $\pi(a) = \frac{a}{1} = \frac{a}{s} \frac{s}{1} \in J \Rightarrow a \in J^c \Rightarrow \frac{a}{s} \in J^{ce} $.
                    In particular, $J = J^{ce} = J^{c}S^{-1}A = S^{-1}J^{c}$.
                    \end{proof}

        \begin{defn}
            (\emph{Total fraction ring}) $Tot(A) \coloneqq S^{-1}A$ where $S = \{a \in A \mid a \text{ is not a zero divisor }\}$.
        \end{defn}

        \begin{defn}
            (\emph{Localization at an element}) $A_f \coloneqq S^{-1}A$ where $S = \{f^n \mid n \geq 0\}$ for a given $f \in A$.
        \end{defn}

        \begin{defn}
            Let $A$ be a ring and $\mathfrak{p} \in \text{Spec}(A)$ a prime ideal.
            Then, the \emph{localization of $A$ at $\mathfrak{p}$} is $A_{\mathfrak{p}} \coloneqq S^{-1}A$, where $S = A \setminus \mathfrak{p}$.
        \end{defn}

        \begin{rk}
            Indeed, $S$ is multiplicatively closed as $\mathfrak{p}$ is prime.
        \end{rk}

        \begin{prop}
            In the above situation, $\frac{a}{s} \in A_{\mathfrak{p}}$ is a unit $\iff a \notin \mathfrak{p}$.
        \end{prop}
            \begin{proof}
                We will show both implications.
                \begin{itemize}
                    \item[$(\Rightarrow)$] Suppose $\frac{a}{s} \in A_{\mathfrak{p}}$ is a unit.
                    Then, there is some $\frac{b}{t} \in A_{\mathfrak{p}}$ such that $\frac{a}{s} \frac{b}{t} = \frac{1}{1}$.
                    For some $u \notin \mathfrak{p}, u (ab - st) = 0$.
                    Rearanging, $uab = ust$.
                    But neither of $u, s, t$ are in $\mathfrak{p}$, so their product $ust$ is not in $\mathfrak{p}$ (because $\mathfrak{p}$ is prime).
                    In particular, $a \notin \mathfrak{p}$.
                    \item[$(\Leftarrow)$] Suppose $a \notin \mathfrak{p}$.
                    Then, $\frac{a}{s} \frac{s}{a} = 1$
                \end{itemize}
            \end{proof}

        \begin{prop}
            In the above situation, $A_{\mathfrak{p}}$ is a local ring with maximal ideal
            $\mathfrak{p}A_{\mathfrak{p}}$.
        \end{prop}
            \begin{proof}
                
                By Proposition~\ref{prop:local}, We just need to show that $\mathfrak{p}A_{\mathfrak{p}} = A_{\mathfrak{p}} \setminus (A_{\mathfrak{p}})^*$.
                Indeed, by \ref{prop:extension-in-fractions} we know $\mathfrak{p}A_{\mathfrak{p}} = \{\frac{a}{s} \mid a \in \mathfrak{p}, s \notin \mathfrak{p} \}$, which by the previous proposition
                is exactly the set of nonunits of $A_{\mathfrak{p}}$.

            \end{proof}

        \begin{theorem}
            We have:
            \begin{itemize}
                \item $S^{-1}I = S^{-1}A \Leftrightarrow I \cap S \neq \emptyset$.
                \item $\mathfrak{p} \in Spec(A)$ s.t. $\mathfrak{p} \cap S = \emptyset \Leftrightarrow S^{-1}\mathfrak{p} \in SpecS^{-1}A$
                \item There is a bijection
                \[
                    \begin{aligned}
                        \left\{ \mathfrak{p} \in SpecA \mid \mathfrak{p} \cap S = \emptyset \right\} &\longleftrightarrow SpecS^{-1}A \\
                        \mathfrak{p} &\longmapsto S^{-1}\mathfrak{p} \\
                        \mathfrak{q} = \mathfrak{q} \cap A &\longmapsfrom \mathfrak{q}
                    \end{aligned}
                \]
            \end{itemize}
        \end{theorem}
            \begin{proof}

                %TODO
                TODO

            \end{proof}

        \begin{prop}
            Let $f:A \longrightarrow B$ be a ring homomorphism.
            Let $S \subseteq A$ and $T \subseteq B$ be multiplicatively closed subsets such that $f(S) \subseteq T$.
            Then there exist a unique $g: S^{-1}A \longrightarrow T^{-1}B$ such that the following diagram is commutative:
            \begin{center}
            \begin{tikzcd}
                A & B \\
                {S^{-1}A} & {T^{-1}B}
                \arrow["f", from=1-1, to=1-2]
                \arrow["\varphi"', from=1-1, to=2-1]
                \arrow["\psi", from=1-2, to=2-2]
                \arrow["g"', from=2-1, to=2-2]
            \end{tikzcd}
            \end{center}
        \end{prop}
            \begin{proof}

                Apply Proposition~\ref{prop:universal-property-fractions} to the composition $\psi \circ f$.
                It is clear that  $\psi \circ f(S) \subset \psi(T) \subset T^{-1}B^*$.

            \end{proof}

        \begin{corollary}
            Let $f:A \longrightarrow A/I$ with a given ideal $I \subseteq A$.
            Let $S \subseteq A$ be a multiplicatively closed set and $\overline{S} \subseteq A/I$ the associated one.
            Then
            \[
                \overline{S}^{-1}A/I \cong \sfrac{S^{-1}A}{S^{-1}I}  %TODO: porque se queda pequeño. AAAhhhh!!! (btw, That's what she asked)
            \]
        \end{corollary}

        \begin{defn}
            The \emph{residue field} of a ring $A$ w.r.t.\ a prime ideal $\mathfrak{p} \in SpecA$ is
            \[
                k(\mathfrak{p}) = \sfrac{A_{\mathfrak{p}}}{\mathfrak{p}A_{\mathfrak{p}}}
            \]
        \end{defn}

        \begin{defn}
            Let $f: A \longrightarrow B$ be a ring homomorphism.
            This induces the morphism $f^*: SpecB \longrightarrow Spec A$, with $f^*(\mathfrak{q}) = \mathfrak{q}^c$.
            Then, the \emph{fiber} of $\mathfrak{p} \in SpecA$ is defined as
            \[
                (f^*)^{-1}(\mathfrak{p}) \coloneqq \left\{ \mathfrak{q} \in SpecB \mid \mathfrak{q}^c = \mathfrak{p} \right\}
            \]
        \end{defn}

        \begin{prop}
            In the conditions of the previous definition, we have that
            \[
                (f^*)^{-1}(\mathfrak{p}) = Spec \left( \sfrac{T^{-1}B}{\mathfrak{p}T^{-1}B} \right) \cong Spec\left( k(\mathfrak{p}) \otimes_A B \right)
            \]
            where $T = f(A \setminus \mathfrak{p})$.
        \end{prop}
            \begin{proof}

                %TODO
                TODO. La primera igualdad la hemos demostrado en clase.
                La segunda solo se enuncia en los apuntes.

            \end{proof}

        \begin{defn}
            Let $\mathfrak{q} \in A$ be a proper ideal.
            We say that $\mathfrak{q}$ is \emph{primary} if fot all $a, b \in A$
            \[
                ab \in \mathfrak{q}, a \notin \mathfrak{q} \Longrightarrow b^n \in \mathfrak{q} \text{ for some } n > 0
            \]
        \end{defn}

        \begin{rk}
            We have:
            \begin{itemize}
                \item $\mathfrak{p}$ prime ideal $\Longrightarrow \mathfrak{p}$ primary ideal.
                \item $\mathfrak{p}$ primary ideal $\notimplies \mathfrak{p}$ prime ideal.
                \item Let $f: A \longrightarrow B$ be a ring homomorphism.
                Then,
                \[
                    \mathfrak{q} \subseteq B \text{ primary ideal } \Longrightarrow \mathfrak{q}^c \subseteq A \text{ primary ideal}
                \]
            \end{itemize}
        \end{rk}

        \begin{prop}
            $\mathfrak{q} \text{ primary ideal } \Longrightarrow rad(\mathfrak{q}) \text{ prime ideal }$
        \end{prop}
            \begin{proof}

                %TODO

            \end{proof}

        \begin{defn}
            In the conditions of the previous proposition, we say that $\mathfrak{q}$ is $\mathfrak{p}$-primary.
        \end{defn}

        \begin{prop}
            Let $\mathfrak{q} \subseteq A$ be an ideal s.t. $rad(\mathfrak{q}) = \mathfrak{m}$ is a maximal ideal.
            Then $\mathfrak{q}$ is primary.
        \end{prop}
            \begin{proof}

                %TODO

            \end{proof}

    \section{Modules}\label{sec:modules}

        \begin{defn}
            We say that $M$ is an \emph{$A$-module} if:
            \begin{itemize}
                \item $(M, +)$ is an abelian group.
                \item We have an action $\cdot: A \times M \longrightarrow M$, called \emph{product by scalar}, which for all $a, b \in A$ and $m, n \in M$ satisfies:
                \begin{itemize}
                    \item $(a + b)m = am + bm$
                    \item $a(m + n) = am + an$
                    \item $(ab)m = a (bm)$
                    \item $1 m = m$
                \end{itemize}
            \end{itemize}
        \end{defn}

        \begin{defn}
            Let $M, N$ be $A$-modules.
            We say that $f: M \longrightarrow N$ is a \emph{ring homomorphism} if, for all $m,n \in M$ and $a \in A$, it satisfies:
            \begin{itemize}
                \item $f(m + n) = f(m) + f(n)$
                \item $f(am) = a f(m)$
            \end{itemize}
            We also define $Hom_A(M,N) = \left\{ f: M \longrightarrow N \mid f \text{ is a ring homomorphism}\right\}$
        \end{defn}

        \begin{rk}
            $Hom_A(M,N)$ is an $A$-module.
            Also, it non-empty since $0 \in Hom_A(M,N)$.
        \end{rk}

        \begin{defn}
            Let $M$ be an $A$-module.
            We say that $N \subseteq M$ is a \emph{submodule} of $M$ if, for all $m, n \in N$ and $a \in A$, it satisfies:
            \begin{itemize}
                \item $m + n \in N$
                \item $am \in N$
            \end{itemize}
        \end{defn}

        \begin{prop}
            Given $M$ $A$-module and $N \subseteq M$ submodule, $M/N$ is an $A$-module.
        \end{prop}

        \begin{prop}
            Let $f: M \longrightarrow N$ be a ring homomorphism.
            Then:
            \begin{itemize}
                \item $P \subseteq M$ submodule $\implies f(P) \subseteq N$ submodule.
                \item $Q \subseteq N$ submodule $\implies f^{-1}(Q) \subseteq M$ submodule.
            \end{itemize}
        \end{prop}

        \begin{rk}
            Let $f: M \longrightarrow Im(f)$ be a ring homomorphism.
            Then:
            \begin{itemize}
                \item $\sfrac{M}{Ker(f)} \cong Im(f)$
                \item Let $N_2 \subseteq N_1 \subseteq M$ submodules.
                Then $\frac{\sfrac{M}{N_2}}{\sfrac{N_1}{N_2}} \cong \sfrac{M}{N_1}$.
                \item Let $N_2, N_1 \subseteq M$ submodules.
                $\sfrac{N_1 + N_2}{N_2} \cong \sfrac{N_1}{N_1 \cap N_2}$.
            \end{itemize}
        \end{rk}

        \begin{defn}
            Let $M$ be an $A$-module.
            We say that it is \emph{free} if $M \cong \bigoplus_{i \in I} M_i$ with $M_i \cong A$
        \end{defn}

        \begin{defn}
            Let $M$ be an $A$-module.
            We say that:
            \begin{itemize}
                \item $S = {m_i}_{i \in I}$ is a \emph{system of generators} if $M = \left<S\right> $, i.e.
                \[
                    M = \left\{ a_1 m_{i_1} + \dots + a_n m_{i_n} \mid a_1, \dots, a_n \in A, m_{i_1}, \dots, m_{i_n} \in S \right\}
                \]
                \item ${m_i}_{i \in I}$ are \emph{linearly independent} if for all $m_{i_1}, \dots, m_{i_n} \in S$ and $a_1, \dots, a_n \in A$
                such that $a_1 m_{i_1} + \dots + a_n m_{i_n} = 0$, we have that $a_1 = \dots = a_n = 0$.
                \item $S = {m_i}_{i \in I}$ is a \emph{basis} of $M$ if it's a system a generators and they are linearly independent.
            \end{itemize}
        \end{defn}

        \begin{rk}
            Consider the morphism:
            \begin{center}
            \begin{aligned}
                \varphi: A^{\oplus{I}} &\longrightarrow M \\
                \left(a_i\right)_{i \in I} &\longmapsto \sum_{i\in I} a_i m_i
            \end{aligned}
            \end{center}
            Then:
            \begin{itemize}
                \item $\varphi$ is exhaustive $\Longleftrightarrow$ ${m_i}_{i\in I}$ is a system of generators of $M$.
                \item $\varphi$ is injective $\Longleftrightarrow$ ${m_i}_{i\in I}$ are linearly independent.
                \item $\varphi$ is isomorphism $\Longleftrightarrow$ ${m_i}_{i\in I}$ is a basis of $M$.
            \end{itemize}
        \end{rk}

        \begin{rk}
            $M$ is a free $A$-module if there exists a basis $\{m_i\}_i \in I$ of $M$.
            In this case
            \[
                M \cong \bigoplus_{i \in I} A m_i
            \]
        \end{rk}

        \begin{defn}
            $M = \left<S\right> $ is \emph{cyclic} if $\#S = 1$.
        \end{defn}

        \begin{rk}
            If $M$ is cyclic, then
            \begin{center}
            \begin{aligned}
                \varphi: A &\longrightarrow M \\
                a &\longmapsto am
            \end{aligned}
            \end{center}
            is surjective.
            Thus $M \cong \sfrac{A}{Ker(f)}$ and $Ker(f)$ is an ideal of $A$.
        \end{rk}

        \begin{theorem}
            Let $M$ be an $A$-module.
        \end{theorem}
\end{document}